!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("sockjs-client")):"function"==typeof define&&define.amd?define(["react","sockjs-client"],t):"object"==typeof exports?exports.reacolo=t(require("react"),require("sockjs-client")):e.reacolo=t(e.React,e.SockJS)}(this,function(e,t){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(7)},function(t,n){t.exports=e},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=o(r),i=function(e){return e.rendered?s.default.createElement("div",null,e.children):null};i.propTypes={rendered:s.default.PropTypes.bool.isRequired,children:s.default.PropTypes.node.isRequired},t.default=i},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=o(r),i=n(2),a=o(i),u={atLeast:function(e,t){return e.every(function(e){return t.roleAssignations[e]>0})},strict:function(e,t){return Object.keys(t.roleAssignations).length===e.length&&u.atLeast(e,t)}},l=function(e,t,n){var o=u[e];return"string"==typeof t[0]?o(t,n):t.some(function(e){return o(e,n)})},c=function(e){var t=l(e.method,e.target,e.context);return s.default.createElement(a.default,{rendered:t},e.children)};c.propTypes={target:s.default.PropTypes.oneOfType([s.default.PropTypes.arrayOf(s.default.PropTypes.string),s.default.PropTypes.arrayOf(s.default.PropTypes.arrayOf(s.default.PropTypes.string))]).isRequired,method:s.default.PropTypes.oneOf(["atLeast","strict"]),children:s.default.PropTypes.node.isRequired,context:s.default.PropTypes.shape({roleAssignations:s.default.PropTypes.objectOf(s.default.PropTypes.number).isRequired}).isRequired},c.defaultProps={method:"atLeast"},t.default=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=o(r),i=n(2),a=o(i),u=function(e,t){return"string"==typeof target?e===t:e.includes(t)},l=function(e){return s.default.createElement(a.default,{rendered:u(e.target,e.context.role)},e.children)};l.propTypes={target:s.default.PropTypes.oneOfType([s.default.PropTypes.string,s.default.PropTypes.arrayOf(s.default.PropTypes.string)]).isRequired,children:s.default.PropTypes.node.isRequired,context:s.default.PropTypes.shape({role:s.default.PropTypes.string}).isRequired},t.default=l},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=o(r);t.default=s.default.PropTypes.shape({role:s.default.PropTypes.string,roleAssignations:s.default.PropTypes.objectOf(s.default.PropTypes.number).isRequired})},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(8),a=o(i),u=function(){},l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http://"+location.host+e._PREFIX,n=arguments[1];r(this,e),this._role=n,this._appData=null,this._context=null,this.onUpdate=u,this.onConnected=u,this.onDisconnected=u,this._socket=new a.default(t),this._socket.onmessage=this._onSocketMessage.bind(this),this._socket.onopen=this._onSocketOpen.bind(this),this._socket.onclose=this._onSocketClose.bind(this)}return s(e,[{key:"setAppData",value:function(e){this._socketSend("set_app_data",e)}},{key:"_onSocketOpen",value:function(){this._role&&this._socketSend("set_socket_role",this._role),this._socketSend("app_data_request",this._role),this.onConnected()}},{key:"_onSocketMessage",value:function(e){var t=JSON.parse(e.data),n=t.type,o=t.data;switch(n){case"app_data":this._appData=o,this.onUpdate(this._appData,this._context);break;case"meta_data":this._context={role:this._role,roleAssignations:o.clientRoles},this.onUpdate(this._appData,this._context);break;default:console.warn("Unknown message type: "+n)}}},{key:"_onSocketClose",value:function(){this.onDisconnected()}},{key:"_socketSend",value:function(e,t){this._socket.send(JSON.stringify({type:e,data:t}))}},{key:"role",get:function(){return this._role}}]),e}();t.default=l,l._PREFIX="/socket"},function(e,t,n){"use strict";var o=n(3),r=n(4),s=n(5),i=n(6);e.exports={EcologyFilter:o,RoleFilter:r,contextPropType:s,dirtyModelSync:i}},function(e,n){e.exports=t}])});
//# sourceMappingURL=reacolo.js.map